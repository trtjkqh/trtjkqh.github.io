<!DOCTYPE html>
<html lang="zh-CN">
<head>
  <meta charset="UTF-8" />
  <meta name="viewport" content="width=device-width, initial-scale=1.0" />
  <title>成品信息查询</title>
  <script src="https://cdn.tailwindcss.com"></script>
  <style>
    body { background-color: #f3f4f6; }
    @keyframes fadeIn { from {opacity:0; transform:translateY(10px);} to {opacity:1; transform:translateY(0);} }
    .fade-in { animation: fadeIn 0.3s ease-in-out; }

    table { border-collapse: collapse; width: 100%; background:white; font-size:0.9rem; }
    table th, table td { border:1px solid #e5e7eb; text-align:center; padding:0.5rem; }
    table th { background-color: #e0f2fe; color:#1e3a8a; font-weight:600; }
    table tr:hover { background-color: #f0f9ff; }
  </style>
</head>
<body class="p-6">

  <!-- 标题栏（Logo + 标题 + 保密声明同一行） -->
  <div class="max-w-6xl mx-auto bg-white shadow-lg rounded-xl p-4 flex items-center justify-between fade-in mb-6">
    <!-- 左侧 Logo -->
    <div class="flex items-center gap-3">
      <img src="assets/img/trtlogo.png" alt="公司Logo" class="h-12 w-12 object-contain" />
      <h1 class="text-2xl font-bold text-gray-700">成品信息查询</h1>
    </div>

    <!-- 右侧保密声明 -->
       <span class="px-2 py-1 bg-yellow-50 border border-yellow-200 rounded text-yellow-700">🔍 数据：2025年7月1日</span>
    <span class="px-2 py-1 bg-red-50 border border-red-200 rounded font-semibold text-red-600">⚠️ 保密声明：内部数据，严禁外传</span>
  </div>

  <!-- 查询条件 -->
  <div class="max-w-6xl mx-auto bg-white shadow-lg rounded-xl p-6 fade-in mb-6">
    <div class="flex flex-wrap items-center gap-4 mb-6">
      <select id="channelSelect" class="border rounded-lg p-2 min-w-[180px] focus:ring focus:ring-blue-200">
        <option value="">选择渠道（可选）</option>
      </select>
      <input id="projectInput" type="text" placeholder="输入项目号（需精准）" class="border rounded-lg p-2 flex-1 min-w-[180px] focus:ring focus:ring-blue-200" />
      <input id="nameInput" type="text" placeholder="输入品名（可模糊搜索）" class="border rounded-lg p-2 flex-1 min-w-[180px] focus:ring focus:ring-blue-200" />
      <button id="searchBtn" class="bg-blue-600 text-white px-4 py-2 rounded-lg hover:bg-blue-700 transition">查询</button>
    </div>

    <!-- 查询结果表格 -->
    <div class="overflow-x-auto">
      <table id="resultTable" class="hidden fade-in">
        <thead>
          <tr>
            <th>项目号</th>
            <th>品名</th>
            <th>规格</th>
            <th>单位</th>
            <th>零售价（元）</th>
            <th>品牌</th>
            <th>渠道</th>
          </tr>
        </thead>
        <tbody id="tableBody"></tbody>
      </table>
    </div>

    <p id="noResult" class="text-center text-gray-500 mt-4 hidden">未找到符合条件的记录。</p>
  </div>

  <script>
    let allData = [];

    fetch('data.json')
      .then(res => res.json())
      .then(data => {
        allData = data;
        populateChannels(data);
      });

    function populateChannels(data) {
      const select = document.getElementById('channelSelect');
      const channels = [...new Set(data.map(item => item.可供应渠道).filter(Boolean))];
      channels.forEach(ch => {
        const option = document.createElement('option');
        option.value = ch;
        option.textContent = ch;
        select.appendChild(option);
      });
    }

    document.getElementById('searchBtn').addEventListener('click', () => {
      const project = document.getElementById('projectInput').value.trim();
      const name = document.getElementById('nameInput').value.trim();
      const channel = document.getElementById('channelSelect').value;

      let filtered = allData.filter(item => {
        const matchProject = project ? item.项目号 === project : true;
        const matchName = name ? item.品名.includes(name) : true;
        const matchChannel = channel ? item.可供应渠道 === channel : true;
        return matchProject && matchName && matchChannel;
      });

      if (!project && !name && channel) {
        filtered = allData.filter(item => item.可供应渠道 === channel);
      }

      renderTable(filtered);
    });

    function renderTable(data) {
      const table = document.getElementById('resultTable');
      const tbody = document.getElementById('tableBody');
      const noResult = document.getElementById('noResult');
      tbody.innerHTML = '';

      if (data.length === 0) {
        table.classList.add('hidden');
        noResult.classList.remove('hidden');
        return;
      }

      noResult.classList.add('hidden');
      table.classList.remove('hidden');

      data.forEach(item => {
        const tr = document.createElement('tr');
        tr.innerHTML = `
          <td>${item.项目号 || ''}</td>
          <td>${item.品名 || ''}</td>
          <td>${item.规格 || ''}</td>
          <td>${item.单位 || ''}</td>
          <td>${item.零售价 ?? item['零售价（元）'] ?? ''}</td>
          <td>${item.品牌 || ''}</td>
          <td>${item.可供应渠道 || ''}</td>
        `;
        tbody.appendChild(tr);
      });
    }
  </script>
</body>
</html>