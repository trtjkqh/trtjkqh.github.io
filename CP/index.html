<!DOCTYPE html>
<html lang="zh-CN">
<head>
  <meta charset="UTF-8">
  <meta name="viewport" content="width=device-width, initial-scale=1.0">
  <title>成品信息查询</title>
  <script src="https://cdn.tailwindcss.com"></script>
  <style>
    body { background: linear-gradient(to bottom right, #fff, #f8f9fb); min-height: 100vh; }
    .card { background: #fff; box-shadow: 0 2px 10px rgba(0,0,0,0.08); border-radius: 12px; }
    th { background-color: #dc2626; color: white; }
    tr:hover { background-color: #f1f5f9; }
    .fade-in { animation: fadeIn 0.4s ease-in-out; }
    @keyframes fadeIn { from { opacity: 0; transform: translateY(10px); } to { opacity: 1; transform: translateY(0); } }
  </style>
</head>
<body class="p-6">
  <div class="max-w-6xl mx-auto card p-6 fade-in">
    <h1 class="text-2xl font-bold mb-4 text-center text-red-700">成品信息查询系统</h1>
    <div class="grid grid-cols-1 md:grid-cols-4 gap-4 mb-6">
      <input id="projectInput" type="text" placeholder="项目号（精确匹配）" class="border p-2 rounded w-full">
      <input id="nameInput" type="text" placeholder="品名（模糊搜索）" class="border p-2 rounded w-full">
      <select id="brandSelect" class="border p-2 rounded w-full">
        <option value="">选择品牌</option>
      </select>
      <select id="channelSelect" class="border p-2 rounded w-full">
        <option value="">选择供应渠道（留空则不限）</option>
      </select>
    </div>

    <div class="flex justify-center gap-4 mb-6">
      <button onclick="searchData()" class="bg-red-600 text-white px-6 py-2 rounded hover:bg-red-700">查询</button>
      <button onclick="resetFilters()" class="border border-red-500 text-red-600 px-6 py-2 rounded hover:bg-red-100">重置</button>
    </div>

    <div class="overflow-x-auto">
      <table class="min-w-full text-sm border">
        <thead>
          <tr>
            <th class="p-2 border">项目号</th>
            <th class="p-2 border">品名</th>
            <th class="p-2 border">规格</th>
            <th class="p-2 border">单位</th>
            <th class="p-2 border">零售价</th>
            <th class="p-2 border">产品属性</th>
            <th class="p-2 border">保质期</th>
            <th class="p-2 border">品牌</th>
            <th class="p-2 border">可供应渠道</th>
          </tr>
        </thead>
        <tbody id="resultTable"></tbody>
      </table>
      <p id="noDataMsg" class="text-center text-gray-500 mt-4 hidden">未找到匹配的数据。</p>
    </div>
  </div>

  <script>
    let data = [];

    fetch('data.json')
      .then(response => response.json())
      .then(json => {
        data = json;
        fillSelectOptions();
      });

    function fillSelectOptions() {
      const brandSet = new Set();
      const channelSet = new Set();
      data.forEach(item => {
        if (item.品牌) brandSet.add(item.品牌);
        if (item.可供应渠道) {
          item.可供应渠道.split('、').forEach(c => channelSet.add(c.trim()));
        }
      });

      const brandSelect = document.getElementById('brandSelect');
      brandSet.forEach(brand => {
        const opt = document.createElement('option');
        opt.value = brand; opt.textContent = brand; brandSelect.appendChild(opt);
      });

      const channelSelect = document.getElementById('channelSelect');
      channelSet.forEach(ch => {
        const opt = document.createElement('option');
        opt.value = ch; opt.textContent = ch; channelSelect.appendChild(opt);
      });
    }

    function searchData() {
      const project = document.getElementById('projectInput').value.trim();
      const name = document.getElementById('nameInput').value.trim().toLowerCase();
      const brand = document.getElementById('brandSelect').value;
      const channel = document.getElementById('channelSelect').value;

      let results = data.filter(item => {
        const projectMatch = project ? item.项目号 === project : true;
        const nameMatch = name ? item.品名.toLowerCase().includes(name) : true;
        const brandMatch = brand ? item.品牌 === brand : true;
        const channelMatch = channel ? item.可供应渠道.includes(channel) : true;
        return projectMatch && nameMatch && brandMatch && channelMatch;
      });

      displayResults(results);
    }

    function displayResults(results) {
      const table = document.getElementById('resultTable');
      const msg = document.getElementById('noDataMsg');
      table.innerHTML = '';

      if (results.length === 0) {
        msg.classList.remove('hidden');
        return;
      }
      msg.classList.add('hidden');

      results.forEach(row => {
        const tr = document.createElement('tr');
        tr.innerHTML = `
          <td class='border p-2 text-center'>${row.项目号}</td>
          <td class='border p-2'>${row.品名}</td>
          <td class='border p-2 text-center'>${row.规格}</td>
          <td class='border p-2 text-center'>${row.单位}</td>
          <td class='border p-2 text-center'>${row.零售价}</td>
          <td class='border p-2 text-center'>${row.产品属性}</td>
          <td class='border p-2 text-center'>${row.保质期}</td>
          <td class='border p-2 text-center'>${row.品牌}</td>
          <td class='border p-2 text-center'>${row.可供应渠道}</td>`;
        table.appendChild(tr);
      });
    }

    function resetFilters() {
      document.getElementById('projectInput').value = '';
      document.getElementById('nameInput').value = '';
      document.getElementById('brandSelect').value = '';
      document.getElementById('channelSelect').value = '';
      document.getElementById('resultTable').innerHTML = '';
      document.getElementById('noDataMsg').classList.add('hidden');
    }
  </script>
</body>
</html>
