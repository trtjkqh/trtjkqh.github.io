<!DOCTYPE html>
<html lang="zh-CN">
<head>
<meta charset="UTF-8">
<meta name="viewport" content="width=device-width, initial-scale=1.0">
<title>æˆå“ä¿¡æ¯æŸ¥è¯¢</title>
<script src="https://cdn.tailwindcss.com"></script>
<script src="https://cdn.jsdelivr.net/npm/xlsx/dist/xlsx.full.min.js"></script>
<style>
  body { background-color:#f3f4f6; }
  @keyframes fadeIn { from {opacity:0; transform:translateY(10px);} to {opacity:1; transform:translateY(0);} }
  .fade-in { animation: fadeIn 0.3s ease-in-out; }
  table { border-collapse:collapse; width:100%; background:white; font-size:0.9rem; }
  th, td { border:1px solid #e5e7eb; padding:0.5rem; text-align:center; }
  th { background:#e0f2fe; color:#1e3a8a; font-weight:600; cursor:pointer; position:sticky; top:0; z-index:10; }
  tr:hover { background:#f0f9ff; }
  .sort-asc::after { content:" â†‘"; color:#0d6efd; }
  .sort-desc::after { content:" â†“"; color:#0d6efd; }
</style>
</head>
<body class="p-6">

<div class="max-w-6xl mx-auto bg-white shadow-lg rounded-xl p-4 flex flex-col md:flex-row justify-between fade-in mb-6">
  <div class="flex items-center gap-3">
    <img src="/assets/img/trtlogo.png" class="h-12 object-contain">
    <div>
      <h1 class="text-2xl font-bold text-gray-700">æˆå“ä¿¡æ¯æŸ¥è¯¢</h1>
      <p class="text-sm text-gray-500">è¾“å…¥æ¡ä»¶åæŸ¥è¯¢</p>
    </div>
  </div>
  <div class="flex flex-col md:flex-row items-center gap-2">
    <span class="px-2 py-1 bg-yellow-50 border rounded text-yellow-700">ğŸ” æ•°æ®ï¼š2025å¹´7æœˆ</span>
    <span class="px-2 py-1 bg-red-50 border rounded font-semibold text-red-600">âš ï¸ ä¿å¯†ï¼šå†…éƒ¨æ•°æ®ä¸¥ç¦å¤–ä¼ </span>
  </div>
</div>

<div class="max-w-6xl mx-auto bg-white shadow-lg rounded-xl p-6 fade-in mb-6 space-y-4">
<div class="flex flex-wrap gap-3">
  <select id="channelSelect" class="border rounded-lg p-2 min-w-[150px]"><option value="">æ‰€æœ‰æ¸ é“</option></select>
  <input id="projectInput" placeholder="é¡¹ç›®å·ï¼ˆç²¾å‡†ï¼‰" class="border rounded-lg p-2 flex-1 min-w-[150px]">
  <input id="nameInput" placeholder="å“åï¼ˆæ¨¡ç³Šæœç´¢ï¼‰" class="border rounded-lg p-2 flex-1 min-w-[150px]">
  <button id="searchBtn" class="bg-blue-600 text-white px-4 py-2 rounded-lg hover:bg-blue-700">æŸ¥è¯¢</button>
  <button id="exportBtn" class="bg-green-600 text-white px-4 py-2 rounded-lg hover:bg-green-700">å¯¼å‡ºExcel</button>
</div>

<div class="overflow-auto max-h-[70vh] border rounded-lg">
<table id="resultTable" class="hidden fade-in">
<thead>
<tr>
  <th data-sort="åºå·">åºå·</th>
  <th data-sort="é¡¹ç›®å·">é¡¹ç›®å·</th>
  <th data-sort="å“å">å“å</th>
  <th data-sort="è§„æ ¼">è§„æ ¼</th>
  <th data-sort="å•ä½">å•ä½</th>
  <th data-sort="é›¶å”®ä»·">é›¶å”®ä»·ï¼ˆå…ƒï¼‰</th>
  <th data-sort="å“ç‰Œ">å“ç‰Œ</th>
  <th data-sort="å¯ä¾›åº”æ¸ é“">æ¸ é“</th>
  <th>BOMæŸ¥è¯¢</th>
</tr>
</thead>
<tbody id="tableBody"></tbody>
</table>
</div>
<p id="noResult" class="text-center text-gray-500 mt-2 hidden">æœªæ‰¾åˆ°è®°å½•</p>
</div>

<footer class="text-center text-gray-500 text-sm mt-6">Â© 2025 é‡‡è´­éƒ¨ | <a href="/CP/index.html">æˆå“ä¿¡æ¯</a> | <a href="/product/index.html">äº§å“æ‰‹å†Œ</a></footer>

<script>
let allData=[],currentData=[];let sortDirection={};
fetch("data.json").then(r=>r.json()).then(data=>{allData=data;const s=document.getElementById("channelSelect");[...new Set(data.map(i=>i.å¯ä¾›åº”æ¸ é“).filter(Boolean))].forEach(c=>{s.innerHTML+=`<option>${c}</option>`})});

function search(){const p=document.getElementById("projectInput").value.trim();const n=document.getElementById("nameInput").value.trim();const c=document.getElementById("channelSelect").value;currentData=allData.filter(i=>(!p||String(i.é¡¹ç›®å·)===p)&&(!n||i.å“å.includes(n))&&(!c||i.å¯ä¾›åº”æ¸ é“===c));renderTable();}

function renderTable(){const t=document.getElementById("resultTable"),tb=document.getElementById("tableBody"),no=document.getElementById("noResult");if(!currentData.length){t.classList.add("hidden");no.classList.remove("hidden");return;}no.classList.add("hidden");t.classList.remove("hidden");tb.innerHTML=currentData.map((i,idx)=>`<tr><td>${idx+1}</td><td>${i.é¡¹ç›®å·||""}</td><td>${i.å“å||""}</td><td>${i.è§„æ ¼||""}</td><td>${i.å•ä½||""}</td><td>${i.é›¶å”®ä»·??""}</td><td>${i.å“ç‰Œ||""}</td><td>${i.å¯ä¾›åº”æ¸ é“||""}</td><td><a href='/bom/index.html?project=${i.é¡¹ç›®å·}' class='text-blue-600 hover:underline' target='_blank'>æŸ¥çœ‹BOM</a></td></tr>`).join("");}

document.querySelectorAll("th").forEach(th=>{th.addEventListener("click",()=>{const k=th.dataset.sort;if(k==="åºå·")return;sortDirection[k]=!sortDirection[k];currentData.sort((a,b)=>{const x=a[k]??0,y=b[k]??0;if(k==="é›¶å”®ä»·"){return sortDirection[k]?Number(x)-Number(y):Number(y)-Number(x);}return sortDirection[k]?String(x).localeCompare(String(y)):String(y).localeCompare(String(x));});document.querySelectorAll("th").forEach(h=>h.classList.remove("sort-asc","sort-desc"));th.classList.add(sortDirection[k]?"sort-asc":"sort-desc");renderTable();})});

document.getElementById("exportBtn").onclick=()=>{if(!currentData.length)return alert("æš‚æ— æ•°æ®");const data=currentData.map((i,idx)=>({åºå·:idx+1,é¡¹ç›®å·:i.é¡¹ç›®å·,å“å:i.å“å,è§„æ ¼:i.è§„æ ¼,å•ä½:i.å•ä½,é›¶å”®ä»·:i.é›¶å”®ä»·,å“ç‰Œ:i.å“ç‰Œ,æ¸ é“:i.å¯ä¾›åº”æ¸ é“}));const ws=XLSX.utils.json_to_sheet(data);const wb=XLSX.utils.book_new();XLSX.utils.book_append_sheet(wb,ws,"æˆå“æŸ¥è¯¢ç»“æœ");XLSX.writeFile(wb,"æˆå“æŸ¥è¯¢.xlsx");};
document.addEventListener("keydown",e=>{if(e.key==="Enter")search()});document.getElementById("searchBtn").onclick=search;
</script>

</body>
</html>
