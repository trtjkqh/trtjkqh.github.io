<!DOCTYPE html>
<html lang="zh-CN">
<head>
<meta charset="UTF-8">
<meta name="viewport" content="width=device-width, initial-scale=1.0">
<title>导出每日待办</title>
<script src="https://cdn.jsdelivr.net/npm/xlsx/dist/xlsx.full.min.js"></script>
</head>
<body>
<script>
  // 读取 localStorage
  const contractData = JSON.parse(localStorage.getItem('contractData'))||[];
  const transitData  = JSON.parse(localStorage.getItem('transitData'))||[];
  const sampleData   = JSON.parse(localStorage.getItem('sampleData'))||[];
  const paymentData  = JSON.parse(localStorage.getItem('paymentData'))||[];

  // 创建工作簿
  const wb = XLSX.utils.book_new();
  wb.Props = {Title:"每日待办", CreatedDate: new Date()};
  wb.SheetNames.push("合同");
  wb.SheetNames.push("物料跟踪");
  wb.SheetNames.push("打样");
  wb.SheetNames.push("应付");

  wb.Sheets["合同"] = XLSX.utils.json_to_sheet(contractData);
  wb.Sheets["物料跟踪"] = XLSX.utils.json_to_sheet(transitData);
  wb.Sheets["打样"] = XLSX.utils.json_to_sheet(sampleData);
  wb.Sheets["应付"] = XLSX.utils.json_to_sheet(paymentData);

  XLSX.writeFile(wb, `每日待办_${new Date().toLocaleDateString()}.xlsx`);

  // 自动关闭导出页面
  setTimeout(()=>{window.close()},500);
</script>
</body>
</html>
