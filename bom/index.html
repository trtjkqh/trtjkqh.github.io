<!DOCTYPE html>
<html lang="zh-CN">
<head>
  <meta charset="UTF-8" />
  <meta name="viewport" content="width=device-width, initial-scale=1.0" />
  <title>BOM æŸ¥è¯¢ç³»ç»Ÿ</title>
  <script src="https://cdn.tailwindcss.com"></script>
</head>
<body class="bg-gray-50 min-h-screen font-sans">

  <!-- é¡µå¤´ -->
  <header class="bg-gradient-to-r from-red-600 to-red-400 text-white py-6 shadow flex flex-col items-center justify-center">
    <img src="/assets/img/trtlogo.png" alt="LOGO" class="h-16 w-auto mb-2 object-contain">
    <h1 class="text-3xl font-bold tracking-wide">äº§å“ BOM æŸ¥è¯¢ç³»ç»Ÿ</h1>
  </header>

  <!-- ä¸»ä½“ -->
  <main class="max-w-7xl mx-auto mt-10 p-6 bg-white rounded-2xl shadow-xl">

    <!-- æŸ¥è¯¢åŒº -->
    <div class="flex flex-col sm:flex-row gap-4 items-center mb-6">
      <input id="search" type="text" placeholder="ğŸ” è¾“å…¥å…³é”®è¯ï¼ˆäº§å“åã€é¡¹ç›®å·ã€ç‰©æ–™åç­‰ï¼‰..." 
             class="flex-1 border border-gray-300 rounded-lg px-4 py-2 text-gray-700 focus:outline-none focus:ring-2 focus:ring-red-400" />
      <button id="searchBtn" 
              class="bg-red-500 hover:bg-red-600 text-white px-6 py-2 rounded-lg shadow transition transform hover:scale-105">
        æŸ¥è¯¢
      </button>
    </div>

    <!-- è¡¨æ ¼åŒº -->
    <div class="overflow-x-auto rounded-lg border border-gray-200">
      <table class="min-w-full text-sm text-gray-700">
        <thead class="bg-gray-100 text-gray-800">
          <tr>
            <th class="py-3 px-3 border-b">äº§å“é¡¹ç›®å·</th>
            <th class="py-3 px-3 border-b">äº§å“åç§°</th>
            <th class="py-3 px-3 border-b">è§„æ ¼</th>
            <th class="py-3 px-3 border-b">å“ç‰Œ</th>
            <th class="py-3 px-3 border-b">ç³»åˆ—</th>
            <th class="py-3 px-3 border-b">ç‰©æ–™é¡¹ç›®å·</th>
            <th class="py-3 px-3 border-b">ç‰©æ–™åç§°</th>
            <th class="py-3 px-3 border-b">æ•°é‡</th>
          </tr>
        </thead>
        <tbody id="tableBody">
          <tr>
            <td colspan="8" class="text-center text-gray-400 py-6">â³ æ•°æ®åŠ è½½ä¸­...</td>
          </tr>
        </tbody>
        <tfoot class="bg-gray-50 font-semibold text-gray-700">
          <tr>
            <td colspan="7" class="text-right py-2 px-3 border-t">æ•°é‡æ±‡æ€»ï¼š</td>
            <td id="totalQty" class="text-right py-2 px-3 border-t">0</td>
          </tr>
        </tfoot>
      </table>
    </div>
  </main>

  <!-- é¡µè„š -->
  <footer class="text-center text-gray-400 text-sm py-6">
    Â© 2025 TRT æ•°æ®ç³»ç»Ÿ | æŠ€æœ¯æ”¯æŒï¼šç‹ç»´
  </footer>

  <!-- JS -->
  <script>
    async function searchData() {
      const query = document.getElementById('search').value.trim();
      const tableBody = document.getElementById('tableBody');
      const totalQty = document.getElementById('totalQty');
      tableBody.innerHTML = "<tr><td colspan='8' class='text-center text-gray-400 py-6'>â³ æ•°æ®åŠ è½½ä¸­...</td></tr>";
      totalQty.textContent = "0";

      try {
        const response = await fetch('data.json');
        const data = await response.json();
        const results = data.filter(item =>
          Object.values(item).some(v => String(v).includes(query))
        );

        if (results.length === 0) {
          tableBody.innerHTML = "<tr><td colspan='8' class='text-center text-gray-400 py-6'>æœªæ‰¾åˆ°åŒ¹é…é¡¹</td></tr>";
          return;
        }

        // è®¡ç®—æ±‡æ€»æ•°é‡
        const sum = results.reduce((acc, cur) => acc + Number(cur.æ•°é‡ || 0), 0);
        totalQty.textContent = sum;

        // æ¸²æŸ“è¡¨æ ¼
        tableBody.innerHTML = results.map(r => `
          <tr class="border-b hover:bg-red-50 transition">
            <td class="py-2 px-3">${r.äº§å“é¡¹ç›®å·}</td>
            <td class="py-2 px-3">${r.äº§å“åç§°}</td>
            <td class="py-2 px-3">${r.è§„æ ¼}</td>
            <td class="py-2 px-3">${r.å“ç‰Œ}</td>
            <td class="py-2 px-3">${r.ç³»åˆ—}</td>
            <td class="py-2 px-3">${r.ç‰©æ–™é¡¹ç›®å·}</td>
            <td class="py-2 px-3">${r.ç‰©æ–™åç§°}</td>
            <td class="py-2 px-3 text-right">${r.æ•°é‡}</td>
          </tr>
        `).join('');
      } catch (e) {
        tableBody.innerHTML = "<tr><td colspan='8' class='text-center text-red-500 py-6'>âŒ æ•°æ®åŠ è½½å¤±è´¥</td></tr>";
        console.error(e);
      }
    }

    // æŒ‰é’®äº‹ä»¶ç»‘å®š
    document.getElementById('searchBtn').addEventListener('click', searchData);
    window.addEventListener('load', searchData);
  </script>
</body>
</html>
