<!DOCTYPE html>
<html lang="zh-CN">
<head>
  <meta charset="UTF-8" />
  <meta name="viewport" content="width=device-width, initial-scale=1.0" />
  <title>供应商信息查询</title>
  <script src="https://cdn.tailwindcss.com"></script>
</head>
<body class="bg-gray-50 min-h-screen">
  <div class="container mx-auto px-4 py-6">
    <h1 class="text-2xl font-bold text-gray-700 mb-4">供应商信息查询</h1>

    <!-- 查询区 -->
    <div class="flex flex-wrap gap-3 mb-6">
      <input id="searchInput" type="text" placeholder="输入供应商名称或简称查询"
        class="border border-gray-300 rounded-lg px-3 py-2 w-64 focus:outline-none focus:ring-2 focus:ring-blue-400" />

      <select id="categorySelect" class="border border-gray-300 rounded-lg px-3 py-2 focus:outline-none">
        <option value="">全部类别</option>
        <option value="包装">包装</option>
        <option value="原料">原料</option>
        <option value="设备">设备</option>
        <option value="辅料">辅料</option>
      </select>

      <!-- 新增两个下拉框 -->
      <select id="compareSelect" class="border border-gray-300 rounded-lg px-3 py-2 focus:outline-none">
        <option value="">是否支持询比价</option>
        <option value="是">是</option>
        <option value="否">否</option>
      </select>

      <select id="sampleSelect" class="border border-gray-300 rounded-lg px-3 py-2 focus:outline-none">
        <option value="">是否支持打样</option>
        <option value="是">是</option>
        <option value="否">否</option>
      </select>

      <button id="searchBtn"
        class="bg-blue-500 text-white px-4 py-2 rounded-lg hover:bg-blue-600 transition">查询</button>
    </div>

    <!-- 表格区 -->
    <div class="overflow-x-auto bg-white shadow rounded-lg">
      <table class="min-w-full table-auto">
        <thead class="bg-gray-100">
          <tr>
            <th class="px-4 py-2 text-left text-gray-600 font-medium">名称</th>
            <th class="px-4 py-2 text-left text-gray-600 font-medium">联系人</th>
            <th class="px-4 py-2 text-left text-gray-600 font-medium">主要产品</th>
            <th class="px-4 py-2 text-left text-gray-600 font-medium">备注</th>
          </tr>
        </thead>
        <tbody id="supplierTable"></tbody>
      </table>
    </div>
  </div>

  <script>
    let supplierData = [];

    // 只加载 supplier/data.json
    async function loadData() {
      try {
        const supplierRes = await fetch("supplier/data.json");
        if (!supplierRes.ok) throw new Error("加载 supplier/data.json 失败");
        supplierData = await supplierRes.json();
      } catch (error) {
        console.error("数据加载出错:", error);
      }
    }

    function renderTable(data) {
      const tableBody = document.getElementById("supplierTable");
      tableBody.innerHTML = "";

      data.forEach(item => {
        const row = `
          <tr class="border-b hover:bg-gray-50">
            <td class="px-4 py-2">${item["名称"] || ""}</td>
            <td class="px-4 py-2">${item["联系人"] || ""}</td>
            <td class="px-4 py-2">${item["主要产品"] || ""}</td>
            <td class="px-4 py-2">${item["备注"] || ""}</td>
          </tr>`;
        tableBody.insertAdjacentHTML("beforeend", row);
      });
    }

    function filterData() {
      const keyword = document.getElementById("searchInput").value.trim();
      const category = document.getElementById("categorySelect").value;
      const compare = document.getElementById("compareSelect").value;
      const sample = document.getElementById("sampleSelect").value;

      let filtered = supplierData;

      if (keyword) {
        filtered = filtered.filter(item =>
          (item["名称"] && item["名称"].includes(keyword)) ||
          (item["简称"] && item["简称"].includes(keyword))
        );
      }

      if (category) {
        filtered = filtered.filter(item => item["供应品类"] === category);
      }

      if (compare) {
        filtered = filtered.filter(item => item["是否支持询比价"] === compare);
      }

      if (sample) {
        filtered = filtered.filter(item => item["是否支持打样"] === sample);
      }

      renderTable(filtered);
    }

    document.getElementById("searchBtn").addEventListener("click", filterData);

    loadData().then(() => renderTable(supplierData));
  </script>
</body>
</html>
